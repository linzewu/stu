<style type="text/css">

.progressbar-text{
z-index: 2;
}
</style>
<table id="videoWarnDG" class="easyui-datagrid"  data-options="rownumbers:true,
		toolbar:'#videoWarnToolbar',
		singleSelect:true,
		pagination:true,
		pageSize:10,
		url:'../../videoWarn/getVideoWarnList',
		onLoadSuccess: onLoadSuccess",
		
		>  
    <thead>
        <tr>  
        	<th data-options="field:'lsh',width:160" >流水号</th>
        	<th data-options="field:'jyjgbh',width:280,formatter:jyjgbhFormatter" >机构名称</th>
        	<th data-options="field:'jycs',width:100" >检验次数</th>
        	<th data-options="field:'deviceName',width:100" >视频名称</th>
            <th data-options="field:'type',width:160,formatter:formatterSpyj" >预警类型</th>
            <th data-options="field:'remark',width:160" >预警信息</th>
            
        </tr>  
      </thead>  
</table>
<div id="videoWarnToolbar"  style="padding:5px;height:auto">
    <div style="margin-bottom:5px">    	
    	<div style="height: 34px;">
    	<input id="quer_spyj"   prompt='请选择预警类型' data-options="data:comm.getBaseParames('spyj'),	valueField: 'id',
		textField: 'value'"  class="easyui-combobox" style="width: 160px;">
    	<a href="#" class="easyui-linkbutton" iconCls="icon-search" onclick="queryVideoWarn()">查询</a>
    	</div>
    </div>
</div>

<script type="text/javascript">
function onLoadSuccess(data){
	var start = 0;
    var end = 0;
    if (data.total > 0) {
        var temp = data.rows[0].lsh;
        for (var i = 1; i < data.rows.length; i++) {
            if (temp == data.rows[i].lsh) {
                end++;
            } else {
                if (end > start) {
                    $(this).datagrid('mergeCells', {
                        index: start,
                        rowspan: end - start + 1,
                        field: 'lsh'
                    })
                }
                temp = data.rows[i].lsh;
                start = i;
                end = i;
            }
        }
        /*这里是为了判断重复内容出现在最后的情况，如ABCC*/
        if (end > start) {
            $(this).datagrid('mergeCells', {
                index: start,
                rowspan: end - start + 1,
                field: 'lsh'
            })
        }
    }
}

function formatterSpyj(value, row, index) {
	return comm.getParamNameByValue("spyj", value);
}

function queryVideoWarn(){	
	var quer_spyj = $("#quer_spyj").combobox("getValue");
	$('#videoWarnDG').datagrid("reload",{type:quer_spyj});

}

</script>
